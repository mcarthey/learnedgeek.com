<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 630">
  <defs>
    <linearGradient id="bg" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0f172a"/>
      <stop offset="50%" style="stop-color:#1e293b"/>
      <stop offset="100%" style="stop-color:#0f172a"/>
    </linearGradient>
    <linearGradient id="pass" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#22c55e"/>
      <stop offset="100%" style="stop-color:#15803d"/>
    </linearGradient>
    <linearGradient id="cloudflare" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f97316"/>
      <stop offset="100%" style="stop-color:#ea580c"/>
    </linearGradient>
    <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur stdDeviation="4" result="blur"/>
      <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="1200" height="630" fill="url(#bg)"/>

  <!-- Grid -->
  <g stroke="#334155" stroke-width="0.5" opacity="0.2">
    <line x1="0" y1="315" x2="1200" y2="315"/>
    <line x1="200" y1="0" x2="200" y2="630"/>
    <line x1="400" y1="0" x2="400" y2="630"/>
    <line x1="600" y1="0" x2="600" y2="630"/>
    <line x1="800" y1="0" x2="800" y2="630"/>
    <line x1="1000" y1="0" x2="1000" y2="630"/>
  </g>

  <!-- Title -->
  <text x="600" y="50" text-anchor="middle" fill="#f8fafc" font-family="system-ui" font-size="24" font-weight="bold">
    Email Authentication Flow
  </text>
  <text x="600" y="75" text-anchor="middle" fill="#64748b" font-family="system-ui" font-size="14">
    How SPF, DKIM, and DMARC protect your domain
  </text>

  <!-- Main flow line -->
  <line x1="100" y1="300" x2="1100" y2="300" stroke="#475569" stroke-width="3" stroke-dasharray="10,5"/>

  <!-- Your Mail Server (Start) -->
  <g transform="translate(100, 300)">
    <!-- Server icon -->
    <rect x="-50" y="-70" width="100" height="80" rx="4" fill="#1e293b" stroke="#3b82f6" stroke-width="2"/>
    <rect x="-40" y="-60" width="80" height="15" rx="2" fill="#3b82f6" opacity="0.3"/>
    <circle cx="-30" cy="-52" r="4" fill="#22c55e"/>
    <rect x="-40" y="-40" width="80" height="15" rx="2" fill="#3b82f6" opacity="0.3"/>
    <circle cx="-30" cy="-32" r="4" fill="#22c55e"/>
    <rect x="-40" y="-20" width="80" height="15" rx="2" fill="#3b82f6" opacity="0.3"/>
    <circle cx="-30" cy="-12" r="4" fill="#3b82f6"/>

    <!-- Label -->
    <text x="0" y="40" text-anchor="middle" fill="#3b82f6" font-family="system-ui" font-size="12" font-weight="bold">YOUR SERVER</text>
    <text x="0" y="55" text-anchor="middle" fill="#64748b" font-family="system-ui" font-size="10">SmarterASP</text>
  </g>

  <!-- Email envelope traveling -->
  <g transform="translate(200, 300)">
    <rect x="-20" y="-15" width="40" height="30" rx="2" fill="#fbbf24" stroke="#f59e0b" stroke-width="2"/>
    <path d="M-18 -13 L0 0 L18 -13" fill="none" stroke="#f59e0b" stroke-width="2"/>
    <!-- Arrow -->
    <path d="M30 0 L50 0 M45 -5 L50 0 L45 5" stroke="#fbbf24" stroke-width="2" fill="none"/>
  </g>

  <!-- DNS/Cloudflare (lookup happens) -->
  <g transform="translate(350, 180)">
    <rect x="-60" y="-50" width="120" height="100" rx="8" fill="#1e293b" stroke="url(#cloudflare)" stroke-width="2"/>
    <!-- Cloudflare-style logo hint -->
    <circle cx="0" cy="-10" r="25" fill="none" stroke="#f97316" stroke-width="3"/>
    <path d="M-15 -10 Q0 -30 15 -10 Q0 10 -15 -10" fill="#f97316" opacity="0.5"/>
    <text x="0" y="25" text-anchor="middle" fill="#f97316" font-family="system-ui" font-size="11" font-weight="bold">CLOUDFLARE</text>
    <text x="0" y="38" text-anchor="middle" fill="#64748b" font-family="system-ui" font-size="9">DNS Records</text>

    <!-- Connection line down -->
    <line x1="0" y1="50" x2="0" y2="70" stroke="#f97316" stroke-width="2" stroke-dasharray="4,2"/>
  </g>

  <!-- SPF Check -->
  <g transform="translate(400, 300)">
    <rect x="-45" y="-50" width="90" height="100" rx="4" fill="#1e293b" stroke="#22c55e" stroke-width="2"/>
    <!-- Shield icon -->
    <path d="M0 -35 L-20 -25 L-20 -5 Q-20 15 0 25 Q20 15 20 -5 L20 -25 Z" fill="none" stroke="#22c55e" stroke-width="2"/>
    <text x="0" y="-5" text-anchor="middle" fill="#22c55e" font-family="monospace" font-size="14" font-weight="bold">SPF</text>
    <!-- Checkmark -->
    <path d="M-8 10 L-3 15 L8 5" stroke="#22c55e" stroke-width="3" fill="none"/>
    <text x="0" y="70" text-anchor="middle" fill="#22c55e" font-family="system-ui" font-size="10" font-weight="bold">PASS</text>
    <text x="0" y="85" text-anchor="middle" fill="#64748b" font-family="system-ui" font-size="9">Server authorized?</text>
  </g>

  <!-- Arrow -->
  <path d="M460 300 L510 300 M505 295 L510 300 L505 305" stroke="#475569" stroke-width="2" fill="none"/>

  <!-- DKIM Check -->
  <g transform="translate(600, 300)">
    <rect x="-45" y="-50" width="90" height="100" rx="4" fill="#1e293b" stroke="#22c55e" stroke-width="2"/>
    <!-- Key icon -->
    <circle cx="-8" cy="-20" r="12" fill="none" stroke="#22c55e" stroke-width="2"/>
    <rect x="2" y="-23" width="25" height="6" rx="2" fill="#22c55e"/>
    <rect x="20" y="-23" width="4" height="12" fill="#22c55e"/>
    <rect x="12" y="-23" width="4" height="8" fill="#22c55e"/>
    <text x="0" y="5" text-anchor="middle" fill="#22c55e" font-family="monospace" font-size="14" font-weight="bold">DKIM</text>
    <!-- Checkmark -->
    <path d="M-8 18 L-3 23 L8 13" stroke="#22c55e" stroke-width="3" fill="none"/>
    <text x="0" y="70" text-anchor="middle" fill="#22c55e" font-family="system-ui" font-size="10" font-weight="bold">PASS</text>
    <text x="0" y="85" text-anchor="middle" fill="#64748b" font-family="system-ui" font-size="9">Signature valid?</text>
  </g>

  <!-- Arrow -->
  <path d="M660 300 L710 300 M705 295 L710 300 L705 305" stroke="#475569" stroke-width="2" fill="none"/>

  <!-- DMARC Check -->
  <g transform="translate(800, 300)">
    <rect x="-45" y="-50" width="90" height="100" rx="4" fill="#1e293b" stroke="#22c55e" stroke-width="2"/>
    <!-- Policy/document icon -->
    <rect x="-15" y="-35" width="30" height="40" rx="2" fill="none" stroke="#22c55e" stroke-width="2"/>
    <line x1="-8" y1="-25" x2="8" y2="-25" stroke="#22c55e" stroke-width="2"/>
    <line x1="-8" y1="-15" x2="8" y2="-15" stroke="#22c55e" stroke-width="2"/>
    <line x1="-8" y1="-5" x2="5" y2="-5" stroke="#22c55e" stroke-width="2"/>
    <text x="0" y="20" text-anchor="middle" fill="#22c55e" font-family="monospace" font-size="12" font-weight="bold">DMARC</text>
    <!-- Checkmark -->
    <path d="M-8 30 L-3 35 L8 25" stroke="#22c55e" stroke-width="3" fill="none"/>
    <text x="0" y="70" text-anchor="middle" fill="#22c55e" font-family="system-ui" font-size="10" font-weight="bold">PASS</text>
    <text x="0" y="85" text-anchor="middle" fill="#64748b" font-family="system-ui" font-size="9">Policy: p=reject</text>
  </g>

  <!-- Arrow -->
  <path d="M860 300 L910 300 M905 295 L910 300 L905 305" stroke="#475569" stroke-width="2" fill="none"/>

  <!-- Receiving Server / Inbox -->
  <g transform="translate(1000, 300)">
    <!-- Inbox icon -->
    <rect x="-50" y="-50" width="100" height="80" rx="4" fill="#1e293b" stroke="#22c55e" stroke-width="2"/>
    <path d="M-40 -10 L0 20 L40 -10" fill="none" stroke="#22c55e" stroke-width="2"/>
    <rect x="-35" y="-40" width="70" height="25" rx="2" fill="#22c55e" opacity="0.2"/>

    <!-- Delivered checkmark -->
    <circle cx="35" cy="-35" r="12" fill="#22c55e"/>
    <path d="M30 -35 L33 -32 L40 -40" stroke="white" stroke-width="2" fill="none"/>

    <text x="0" y="50" text-anchor="middle" fill="#22c55e" font-family="system-ui" font-size="12" font-weight="bold">DELIVERED</text>
    <text x="0" y="65" text-anchor="middle" fill="#64748b" font-family="system-ui" font-size="10">To Inbox</text>
  </g>

  <!-- DNS Record Types Legend -->
  <g transform="translate(150, 500)">
    <rect x="-100" y="-40" width="900" height="90" rx="4" fill="#1e293b" stroke="#334155" stroke-width="1"/>
    <text x="0" y="-20" fill="#94a3b8" font-family="system-ui" font-size="11" font-weight="bold">DNS RECORDS REQUIRED:</text>

    <!-- MX -->
    <g transform="translate(0, 10)">
      <rect x="-5" y="-10" width="35" height="20" rx="2" fill="#3b82f6" opacity="0.3"/>
      <text x="12" y="5" text-anchor="middle" fill="#3b82f6" font-family="monospace" font-size="11" font-weight="bold">MX</text>
      <text x="50" y="5" fill="#64748b" font-family="system-ui" font-size="10">Mail server address</text>
    </g>

    <!-- SPF -->
    <g transform="translate(180, 10)">
      <rect x="-5" y="-10" width="35" height="20" rx="2" fill="#22c55e" opacity="0.3"/>
      <text x="12" y="5" text-anchor="middle" fill="#22c55e" font-family="monospace" font-size="11" font-weight="bold">SPF</text>
      <text x="50" y="5" fill="#64748b" font-family="system-ui" font-size="10">Authorized senders</text>
    </g>

    <!-- DKIM -->
    <g transform="translate(360, 10)">
      <rect x="-5" y="-10" width="45" height="20" rx="2" fill="#22c55e" opacity="0.3"/>
      <text x="17" y="5" text-anchor="middle" fill="#22c55e" font-family="monospace" font-size="11" font-weight="bold">DKIM</text>
      <text x="60" y="5" fill="#64748b" font-family="system-ui" font-size="10">Cryptographic signature</text>
    </g>

    <!-- DMARC -->
    <g transform="translate(560, 10)">
      <rect x="-5" y="-10" width="55" height="20" rx="2" fill="#22c55e" opacity="0.3"/>
      <text x="22" y="5" text-anchor="middle" fill="#22c55e" font-family="monospace" font-size="11" font-weight="bold">DMARC</text>
      <text x="70" y="5" fill="#64748b" font-family="system-ui" font-size="10">Enforcement policy</text>
    </g>

    <text x="350" y="35" text-anchor="middle" fill="#475569" font-family="system-ui" font-size="10">
      All records stored in Cloudflare DNS (your authoritative nameserver)
    </text>
  </g>

  <!-- Spoofed email (rejected) - small illustration -->
  <g transform="translate(800, 180)" opacity="0.7">
    <text x="0" y="-30" text-anchor="middle" fill="#ef4444" font-family="system-ui" font-size="10">Spoofed emails</text>
    <!-- Fake envelope -->
    <rect x="-15" y="-20" width="30" height="22" rx="2" fill="#ef4444" opacity="0.3" stroke="#ef4444" stroke-width="1"/>
    <path d="M-13 -18 L0 -8 L13 -18" fill="none" stroke="#ef4444" stroke-width="1"/>
    <!-- X mark -->
    <circle cx="20" cy="-10" r="10" fill="#ef4444" opacity="0.8"/>
    <path d="M16 -14 L24 -6 M24 -14 L16 -6" stroke="white" stroke-width="2"/>
    <text x="0" y="15" text-anchor="middle" fill="#ef4444" font-family="system-ui" font-size="9">REJECTED</text>
  </g>
</svg>
