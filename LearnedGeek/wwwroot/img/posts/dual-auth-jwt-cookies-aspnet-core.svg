<svg viewBox="0 0 800 450" xmlns="http://www.w3.org/2000/svg">
  <rect width="800" height="450" fill="#1a1a2e"/>
  <defs>
    <pattern id="grid4" width="40" height="40" patternUnits="userSpaceOnUse">
      <path d="M 40 0 L 0 0 0 40" fill="none" stroke="#2a2a3e" stroke-width="0.5"/>
    </pattern>
  </defs>
  <rect width="800" height="450" fill="url(#grid4)" opacity="0.3"/>

  <!-- Left side: JWT Token -->
  <rect x="40" y="60" width="320" height="240" fill="#282a36" rx="8" stroke="#f1fa8c" stroke-width="2"/>
  <text x="200" y="90" font-family="'Segoe UI', sans-serif" font-size="16" fill="#f1fa8c" text-anchor="middle" font-weight="bold">JWT Bearer Token</text>
  <line x1="80" y1="100" x2="320" y2="100" stroke="#44475a" stroke-width="1"/>

  <!-- JWT sections -->
  <rect x="70" y="115" width="260" height="24" fill="#ff6b6b" rx="3" opacity="0.8"/>
  <text x="200" y="132" font-family="monospace" font-size="10" fill="#fff" text-anchor="middle">eyJhbGciOiJIUzI1NiJ9</text>

  <rect x="70" y="145" width="260" height="24" fill="#bd93f9" rx="3" opacity="0.8"/>
  <text x="200" y="162" font-family="monospace" font-size="10" fill="#fff" text-anchor="middle">"PlayerId":"abc", "Tier":"Premium"</text>

  <rect x="70" y="175" width="260" height="24" fill="#8be9fd" rx="3" opacity="0.8"/>
  <text x="200" y="192" font-family="monospace" font-size="10" fill="#fff" text-anchor="middle">HMACSHA256(signature)</text>

  <text x="200" y="225" font-family="monospace" font-size="10" fill="#6272a4" text-anchor="middle">Authorization: Bearer ...</text>
  <text x="200" y="245" font-family="monospace" font-size="9" fill="#f8f8f2" text-anchor="middle">curl, Postman, Python clients</text>
  <text x="200" y="265" font-family="monospace" font-size="9" fill="#6272a4" text-anchor="middle">Stateless | /api/v1/*</text>
  <text x="200" y="283" font-family="monospace" font-size="9" fill="#ff5555" text-anchor="middle">ClockSkew = TimeSpan.Zero</text>

  <!-- Right side: Cookie -->
  <rect x="440" y="60" width="320" height="240" fill="#282a36" rx="8" stroke="#50fa7b" stroke-width="2"/>
  <text x="600" y="90" font-family="'Segoe UI', sans-serif" font-size="16" fill="#50fa7b" text-anchor="middle" font-weight="bold">Auth Cookie</text>
  <line x1="480" y1="100" x2="720" y2="100" stroke="#44475a" stroke-width="1"/>

  <!-- Cookie visualization -->
  <rect x="470" y="115" width="260" height="24" fill="#50fa7b" rx="3" opacity="0.3"/>
  <text x="600" y="132" font-family="monospace" font-size="10" fill="#50fa7b" text-anchor="middle">.AspNetCore.Cookies=encrypted</text>

  <text x="600" y="165" font-family="monospace" font-size="10" fill="#f8f8f2" text-anchor="middle">HttpOnly = true</text>
  <text x="600" y="183" font-family="monospace" font-size="10" fill="#f8f8f2" text-anchor="middle">SameSite = Lax</text>
  <text x="600" y="201" font-family="monospace" font-size="10" fill="#f8f8f2" text-anchor="middle">Secure = Always</text>
  <text x="600" y="225" font-family="monospace" font-size="9" fill="#f8f8f2" text-anchor="middle">Browser-based dashboard</text>
  <text x="600" y="245" font-family="monospace" font-size="9" fill="#6272a4" text-anchor="middle">Session-based | Razor Pages</text>
  <text x="600" y="265" font-family="monospace" font-size="9" fill="#f1fa8c" text-anchor="middle">8h sliding / 30d max</text>
  <text x="600" y="283" font-family="monospace" font-size="9" fill="#50fa7b" text-anchor="middle">CSRF via antiforgery</text>

  <!-- Center: Policy Scheme Router -->
  <rect x="300" y="320" width="200" height="60" fill="#2a2a3e" rx="8" stroke="#ff79c6" stroke-width="2"/>
  <text x="400" y="344" font-family="monospace" font-size="11" fill="#ff79c6" text-anchor="middle" font-weight="bold">PolicyScheme</text>
  <text x="400" y="362" font-family="monospace" font-size="9" fill="#f8f8f2" text-anchor="middle">JWT_OR_COOKIE</text>

  <!-- Arrows from router to each scheme -->
  <line x1="330" y1="320" x2="200" y2="300" stroke="#f1fa8c" stroke-width="1.5"/>
  <polygon points="200,296 206,304 196,304" fill="#f1fa8c"/>
  <line x1="470" y1="320" x2="600" y2="300" stroke="#50fa7b" stroke-width="1.5"/>
  <polygon points="600,296 606,304 596,304" fill="#50fa7b"/>

  <!-- Decision labels -->
  <text x="240" y="316" font-family="monospace" font-size="8" fill="#f1fa8c">Bearer header?</text>
  <text x="510" y="316" font-family="monospace" font-size="8" fill="#50fa7b">else</text>

  <!-- Title -->
  <text x="400" y="416" font-family="'Segoe UI', Arial, sans-serif" font-size="22" fill="#f8f8f2" text-anchor="middle" font-weight="bold">Dual Authentication</text>
  <text x="400" y="440" font-family="'Segoe UI', Arial, sans-serif" font-size="14" fill="#6272a4" text-anchor="middle">JWT for API, Cookies for Web â€” one app, zero conflicts</text>
</svg>