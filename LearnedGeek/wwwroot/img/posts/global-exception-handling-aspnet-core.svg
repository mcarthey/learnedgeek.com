<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 630">
  <defs>
    <linearGradient id="bgGrad3" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#1e1e2e"/>
      <stop offset="100%" style="stop-color:#2d2d44"/>
    </linearGradient>
    <linearGradient id="errorGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#ff6b6b"/>
      <stop offset="100%" style="stop-color:#ee5a5a"/>
    </linearGradient>
    <linearGradient id="middlewareGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#667eea"/>
      <stop offset="100%" style="stop-color:#764ba2"/>
    </linearGradient>
    <linearGradient id="jsonGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#00b894"/>
      <stop offset="100%" style="stop-color:#00cec9"/>
    </linearGradient>
  </defs>

  <!-- Background -->
  <rect width="1200" height="630" fill="url(#bgGrad3)"/>

  <!-- Subtle code pattern background -->
  <g opacity="0.03" fill="white" font-family="monospace" font-size="10">
    <text x="20" y="50">try { await _next(context); }</text>
    <text x="150" y="100">catch (Exception ex) { }</text>
    <text x="80" y="150">HandleExceptionAsync()</text>
    <text x="900" y="80">correlationId</text>
    <text x="850" y="180">statusCode: 500</text>
    <text x="1000" y="130">message</text>
  </g>

  <!-- Title -->
  <text x="600" y="55" font-family="Arial, sans-serif" font-size="34" font-weight="bold"
        fill="white" text-anchor="middle">Global Exception Handling</text>
  <text x="600" y="90" font-family="Arial, sans-serif" font-size="18"
        fill="#b2bec3" text-anchor="middle">Centralized Error Responses in ASP.NET Core</text>

  <!-- Request Flow Diagram -->
  <g transform="translate(50, 140)">
    <!-- HTTP Request -->
    <g transform="translate(0, 100)">
      <rect x="0" y="0" width="120" height="50" rx="8" fill="#3498db"/>
      <text x="60" y="20" font-family="Arial, sans-serif" font-size="12" font-weight="bold"
            fill="white" text-anchor="middle">HTTP</text>
      <text x="60" y="38" font-family="Arial, sans-serif" font-size="12"
            fill="white" text-anchor="middle">Request</text>
    </g>

    <!-- Arrow to middleware -->
    <path d="M130,125 L180,125" stroke="white" stroke-width="2" fill="none"/>
    <polygon points="180,125 170,120 170,130" fill="white"/>

    <!-- Middleware Shield -->
    <g transform="translate(190, 50)">
      <rect x="0" y="0" width="200" height="150" rx="10" fill="url(#middlewareGrad)" stroke="#764ba2" stroke-width="2"/>
      <text x="100" y="30" font-family="Arial, sans-serif" font-size="14" font-weight="bold"
            fill="white" text-anchor="middle">Exception Handler</text>
      <text x="100" y="50" font-family="Arial, sans-serif" font-size="12"
            fill="rgba(255,255,255,0.8)" text-anchor="middle">Middleware</text>

      <!-- Try-catch visualization -->
      <rect x="20" y="65" width="160" height="70" rx="5" fill="rgba(0,0,0,0.2)"/>
      <text x="100" y="85" font-family="monospace" font-size="10" fill="white" text-anchor="middle">try {</text>
      <text x="100" y="100" font-family="monospace" font-size="10" fill="#00cec9" text-anchor="middle">  await _next()</text>
      <text x="100" y="115" font-family="monospace" font-size="10" fill="white" text-anchor="middle">} catch { ... }</text>
    </g>

    <!-- Arrow to controllers -->
    <path d="M400,125 L450,125" stroke="white" stroke-width="2" fill="none"/>
    <polygon points="450,125 440,120 440,130" fill="white"/>

    <!-- Controllers -->
    <g transform="translate(460, 70)">
      <rect x="0" y="0" width="150" height="110" rx="8" fill="#2c3e50" stroke="#34495e" stroke-width="2"/>
      <text x="75" y="25" font-family="Arial, sans-serif" font-size="12" font-weight="bold"
            fill="white" text-anchor="middle">Controllers</text>

      <rect x="15" y="40" width="120" height="25" rx="4" fill="#34495e"/>
      <text x="75" y="57" font-family="monospace" font-size="10" fill="#e74c3c" text-anchor="middle">throw Exception!</text>

      <rect x="15" y="75" width="120" height="25" rx="4" fill="#34495e"/>
      <text x="75" y="92" font-family="monospace" font-size="10" fill="#95a5a6" text-anchor="middle">No try-catch needed</text>
    </g>

    <!-- Error bubble back -->
    <path d="M530,180 C530,220 400,220 400,200" stroke="#e74c3c" stroke-width="2" stroke-dasharray="5,3" fill="none"/>
    <text x="465" y="235" font-family="monospace" font-size="10" fill="#e74c3c" text-anchor="middle">Exception</text>
  </g>

  <!-- Response Examples -->
  <g transform="translate(680, 130)">
    <text x="220" y="0" font-family="Arial, sans-serif" font-size="18" font-weight="bold"
          fill="white" text-anchor="middle">Response Transformation</text>

    <!-- Production Response -->
    <g transform="translate(0, 30)">
      <rect x="0" y="0" width="200" height="140" rx="8" fill="#1a1a2e" stroke="#00b894" stroke-width="2"/>
      <rect x="0" y="0" width="200" height="30" rx="8" fill="#00b894"/>
      <rect x="0" y="20" width="200" height="10" fill="#00b894"/>
      <text x="100" y="20" font-family="Arial, sans-serif" font-size="12" font-weight="bold"
            fill="white" text-anchor="middle">Production</text>

      <text x="15" y="55" font-family="monospace" font-size="9" fill="#00cec9">{</text>
      <text x="25" y="70" font-family="monospace" font-size="9" fill="#ecf0f1">"correlationId":</text>
      <text x="25" y="85" font-family="monospace" font-size="9" fill="#f39c12">"0HN5F4G8L2K1P"</text>
      <text x="25" y="100" font-family="monospace" font-size="9" fill="#ecf0f1">"message": "Not found"</text>
      <text x="25" y="115" font-family="monospace" font-size="9" fill="#ecf0f1">"statusCode": 404</text>
      <text x="15" y="130" font-family="monospace" font-size="9" fill="#00cec9">}</text>
    </g>

    <!-- Development Response -->
    <g transform="translate(240, 30)">
      <rect x="0" y="0" width="200" height="200" rx="8" fill="#1a1a2e" stroke="#f39c12" stroke-width="2"/>
      <rect x="0" y="0" width="200" height="30" rx="8" fill="#f39c12"/>
      <rect x="0" y="20" width="200" height="10" fill="#f39c12"/>
      <text x="100" y="20" font-family="Arial, sans-serif" font-size="12" font-weight="bold"
            fill="white" text-anchor="middle">Development</text>

      <text x="15" y="55" font-family="monospace" font-size="9" fill="#f39c12">{</text>
      <text x="25" y="70" font-family="monospace" font-size="9" fill="#ecf0f1">"correlationId":</text>
      <text x="25" y="85" font-family="monospace" font-size="9" fill="#f39c12">"0HN5F4G8L2K1P"</text>
      <text x="25" y="100" font-family="monospace" font-size="9" fill="#ecf0f1">"message": "Not found"</text>
      <text x="25" y="115" font-family="monospace" font-size="9" fill="#ecf0f1">"statusCode": 404</text>
      <text x="25" y="130" font-family="monospace" font-size="9" fill="#e74c3c">"detail": "WorkOrder</text>
      <text x="35" y="145" font-family="monospace" font-size="9" fill="#e74c3c">with ID 'abc' not found"</text>
      <text x="25" y="160" font-family="monospace" font-size="9" fill="#e74c3c">"stackTrace": "..."</text>
      <text x="15" y="175" font-family="monospace" font-size="9" fill="#f39c12">}</text>
    </g>

    <!-- Shield icon -->
    <g transform="translate(170, 250)">
      <path d="M50,0 L100,20 L100,60 C100,90 50,105 50,105 C50,105 0,90 0,60 L0,20 Z"
            fill="#667eea" opacity="0.8"/>
      <text x="50" y="45" font-family="Arial, sans-serif" font-size="10" font-weight="bold"
            fill="white" text-anchor="middle">SECURE</text>
      <text x="50" y="60" font-family="monospace" font-size="8" fill="white" text-anchor="middle">No leaks</text>
    </g>
  </g>

  <!-- Exception Mapping Table -->
  <g transform="translate(50, 400)">
    <text x="0" y="0" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white">Exception Mapping</text>

    <g transform="translate(0, 20)">
      <rect x="0" y="0" width="180" height="35" rx="5" fill="#e74c3c" opacity="0.8"/>
      <text x="90" y="15" font-family="monospace" font-size="10" fill="white" text-anchor="middle">ArgumentException</text>
      <text x="90" y="28" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle">→ 400 Bad Request</text>
    </g>

    <g transform="translate(200, 20)">
      <rect x="0" y="0" width="180" height="35" rx="5" fill="#9b59b6" opacity="0.8"/>
      <text x="90" y="15" font-family="monospace" font-size="10" fill="white" text-anchor="middle">KeyNotFoundException</text>
      <text x="90" y="28" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle">→ 404 Not Found</text>
    </g>

    <g transform="translate(400, 20)">
      <rect x="0" y="0" width="180" height="35" rx="5" fill="#f39c12" opacity="0.8"/>
      <text x="90" y="15" font-family="monospace" font-size="10" fill="white" text-anchor="middle">UnauthorizedAccess</text>
      <text x="90" y="28" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle">→ 401 Unauthorized</text>
    </g>
  </g>

  <!-- Correlation ID Flow -->
  <g transform="translate(650, 410)">
    <text x="225" y="0" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white" text-anchor="middle">Support Flow</text>

    <g transform="translate(0, 20)">
      <!-- User -->
      <circle cx="40" cy="40" r="25" fill="#3498db"/>
      <text x="40" y="45" font-family="Arial, sans-serif" font-size="20" fill="white" text-anchor="middle">?</text>
      <text x="40" y="80" font-family="Arial, sans-serif" font-size="10" fill="#95a5a6" text-anchor="middle">User</text>

      <!-- Arrow -->
      <path d="M75,40 L130,40" stroke="#00b894" stroke-width="2"/>
      <polygon points="130,40 120,35 120,45" fill="#00b894"/>
      <text x="102" y="30" font-family="monospace" font-size="8" fill="#00b894">ID</text>

      <!-- Support -->
      <circle cx="160" cy="40" r="25" fill="#9b59b6"/>
      <text x="160" y="45" font-family="Arial, sans-serif" font-size="16" fill="white" text-anchor="middle">@</text>
      <text x="160" y="80" font-family="Arial, sans-serif" font-size="10" fill="#95a5a6" text-anchor="middle">Support</text>

      <!-- Arrow -->
      <path d="M195,40 L250,40" stroke="#00b894" stroke-width="2"/>
      <polygon points="250,40 240,35 240,45" fill="#00b894"/>

      <!-- Logs -->
      <rect x="260" y="15" width="80" height="50" rx="5" fill="#2c3e50" stroke="#00b894" stroke-width="2"/>
      <text x="300" y="35" font-family="monospace" font-size="10" fill="#00b894" text-anchor="middle">LOGS</text>
      <text x="300" y="50" font-family="monospace" font-size="8" fill="#95a5a6" text-anchor="middle">Full context</text>
      <text x="300" y="80" font-family="Arial, sans-serif" font-size="10" fill="#95a5a6" text-anchor="middle">Search</text>

      <!-- Arrow -->
      <path d="M350,40 L405,40" stroke="#00b894" stroke-width="2"/>
      <polygon points="405,40 395,35 395,45" fill="#00b894"/>

      <!-- Fix -->
      <circle cx="435" cy="40" r="25" fill="#00b894"/>
      <text x="435" y="45" font-family="Arial, sans-serif" font-size="16" fill="white" text-anchor="middle">FIX</text>
      <text x="435" y="80" font-family="Arial, sans-serif" font-size="10" fill="#95a5a6" text-anchor="middle">Resolved</text>
    </g>
  </g>

  <!-- Bottom tagline -->
  <text x="600" y="590" font-family="Arial, sans-serif" font-size="14"
        fill="#667eea" text-anchor="middle">Consistent errors. No leaked details. Traceable support.</text>
</svg>