<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <title>CrewTrack Project Status - BYCO Inc.</title>
    <link rel="stylesheet" href="/css/site.css">
    <style>
        /* Progress ring styles */
        .progress-ring-container {
            position: relative;
            width: 100px;
            height: 100px;
        }
        .progress-ring-container.small {
            width: 80px;
            height: 80px;
        }
        .progress-ring {
            transform: rotate(-90deg);
        }
        .progress-ring-bg {
            fill: none;
            stroke: #e5e5e5;
            stroke-width: 8;
        }
        .dark .progress-ring-bg {
            stroke: #404040;
        }
        .progress-ring-fill {
            fill: none;
            stroke: #171717;
            stroke-width: 8;
            stroke-linecap: round;
            transition: stroke-dashoffset 0.5s ease;
        }
        .progress-ring-fill.complete {
            stroke: #22c55e;
        }
        .progress-ring-fill.upcoming {
            stroke: #a3a3a3;
        }
        .dark .progress-ring-fill {
            stroke: #f5f5f5;
        }
        .dark .progress-ring-fill.complete {
            stroke: #22c55e;
        }
        .dark .progress-ring-fill.upcoming {
            stroke: #525252;
        }
        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }

        /* Phase grid */
        .phases-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }
        .phase-card {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            padding: 1rem;
            border-radius: 0.5rem;
            background: #fafafa;
        }
        .dark .phase-card {
            background: #262626;
        }
        .phase-card.active {
            background: #f5f5f5;
            border: 2px solid #171717;
        }
        .dark .phase-card.active {
            background: #303030;
            border-color: #f5f5f5;
        }
        .phase-name {
            font-weight: 500;
            margin-top: 0.75rem;
            font-size: 0.875rem;
        }
        .phase-detail {
            font-size: 0.75rem;
            color: #737373;
            margin-top: 0.25rem;
        }
        .dark .phase-detail {
            color: #a3a3a3;
        }

        /* Timeline styles */
        .timeline {
            position: relative;
            padding-left: 30px;
        }
        .timeline::before {
            content: '';
            position: absolute;
            left: 9px;
            top: 8px;
            bottom: 8px;
            width: 2px;
            background: #e5e5e5;
        }
        .dark .timeline::before {
            background: #404040;
        }
        .timeline-item {
            position: relative;
            padding-bottom: 20px;
        }
        .timeline-item:last-child {
            padding-bottom: 0;
        }
        .timeline-marker {
            position: absolute;
            left: -30px;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            color: white;
        }
        .timeline-marker.complete {
            background: #22c55e;
        }
        .timeline-marker.in-progress {
            background: #171717;
            animation: pulse 2s infinite;
        }
        .dark .timeline-marker.in-progress {
            background: #f5f5f5;
        }
        .timeline-marker.upcoming {
            background: white;
            border: 2px solid #e5e5e5;
        }
        .dark .timeline-marker.upcoming {
            background: #262626;
            border-color: #404040;
        }
        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(23, 23, 23, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(23, 23, 23, 0); }
        }
        .dark .timeline-marker.in-progress {
            animation-name: pulse-dark;
        }
        @keyframes pulse-dark {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 245, 245, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 245, 245, 0); }
        }

        /* Activity icon */
        .activity-icon {
            width: 36px;
            height: 36px;
            background: #f5f5f5;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            font-size: 14px;
        }
        .dark .activity-icon {
            background: #404040;
        }

        /* Status badge */
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        .status-badge.in-progress {
            background: #f5f5f5;
            color: #171717;
        }
        .dark .status-badge.in-progress {
            background: #404040;
            color: #f5f5f5;
        }

        /* Loading state */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 200px;
        }
        .loading::after {
            content: '';
            width: 32px;
            height: 32px;
            border: 3px solid #e5e5e5;
            border-top-color: #171717;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        .dark .loading::after {
            border-color: #404040;
            border-top-color: #f5f5f5;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Error state */
        .error {
            text-align: center;
            padding: 2rem;
            color: #dc2626;
        }
        .dark .error {
            color: #f87171;
        }
    </style>
    <script>
        // Theme handling - match main site behavior
        (function() {
            if (localStorage.getItem('theme') === 'dark') {
                document.documentElement.classList.add('dark');
            }
        })();
    </script>
</head>
<body class="min-h-screen bg-white text-neutral-900 dark:bg-neutral-900 dark:text-neutral-100 transition-colors">
    <div class="max-w-3xl mx-auto px-4 py-8">
        <!-- Header -->
        <header id="header" class="mb-8">
            <div class="loading">Loading...</div>
        </header>

        <!-- Phases Section -->
        <section id="phases" class="mb-8 p-6 border border-neutral-200 dark:border-neutral-700 rounded-lg">
            <div class="loading"></div>
        </section>

        <!-- Timeline Section -->
        <section id="milestones" class="mb-8 p-6 border border-neutral-200 dark:border-neutral-700 rounded-lg">
            <div class="loading"></div>
        </section>

        <!-- Recent Activity Section -->
        <section id="activities" class="mb-8 p-6 border border-neutral-200 dark:border-neutral-700 rounded-lg">
            <div class="loading"></div>
        </section>

        <!-- Footer -->
        <footer class="text-center py-6 text-sm text-neutral-500 dark:text-neutral-400">
            <p>Built by <a href="https://learnedgeek.com" class="underline hover:text-neutral-900 dark:hover:text-white">LearnedGeek</a></p>
            <p class="mt-1">Questions? Contact Mark at mark@learnedgeek.com</p>
        </footer>
    </div>

    <script>
        const iconMap = {
            device: '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><rect x="5" y="2" width="14" height="20" rx="2" stroke-width="2"/><line x1="12" y1="18" x2="12" y2="18" stroke-width="3" stroke-linecap="round"/></svg>',
            check: '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><polyline points="20,6 9,17 4,12" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',
            design: '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke-width="2"/><path d="M12 2a10 10 0 0 1 0 20" fill="currentColor" opacity="0.3"/></svg>',
            document: '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke-width="2"/><polyline points="14,2 14,8 20,8" stroke-width="2"/></svg>',
            architecture: '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><rect x="3" y="3" width="7" height="7" stroke-width="2"/><rect x="14" y="3" width="7" height="7" stroke-width="2"/><rect x="14" y="14" width="7" height="7" stroke-width="2"/><rect x="3" y="14" width="7" height="7" stroke-width="2"/></svg>'
        };

        async function loadData() {
            try {
                const response = await fetch('/byco.json?' + Date.now());
                if (!response.ok) throw new Error('Failed to load data');
                const data = await response.json();
                renderPage(data);
            } catch (error) {
                console.error('Error loading data:', error);
                document.querySelectorAll('.loading').forEach(el => {
                    el.innerHTML = '<div class="error">Failed to load project data. Please refresh the page.</div>';
                });
            }
        }

        function renderPage(data) {
            renderHeader(data.project);
            renderPhases(data.phases, data.project);
            renderMilestones(data.milestones);
            renderActivities(data.activities);
        }

        function renderHeader(project) {
            document.getElementById('header').innerHTML = `
                <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4">
                    <div>
                        <h1 class="text-3xl font-semibold tracking-tight">${project.name}</h1>
                        <p class="text-neutral-500 dark:text-neutral-400 mt-1">${project.subtitle}</p>
                    </div>
                    <div class="text-sm text-neutral-500 dark:text-neutral-400 bg-neutral-100 dark:bg-neutral-800 px-4 py-2 rounded-full">
                        Updated: ${project.lastUpdated}
                    </div>
                </div>
            `;
        }

        function renderPhases(phases, project) {
            const circumference = 2 * Math.PI * 34; // radius 34 for 80px ring

            const phaseCards = phases.map(phase => {
                const offset = circumference * (1 - phase.percent / 100);
                const isActive = phase.status === 'in-progress';
                const strokeClass = phase.status === 'complete' ? 'complete' : (phase.status === 'upcoming' ? 'upcoming' : '');

                let detail = '';
                if (phase.week) {
                    detail = phase.week;
                } else if (phase.target) {
                    detail = phase.target;
                } else if (phase.status === 'complete') {
                    detail = 'Complete';
                }

                return `
                    <div class="phase-card ${isActive ? 'active' : ''}">
                        <div class="progress-ring-container small">
                            <svg class="progress-ring" width="80" height="80">
                                <circle class="progress-ring-bg" cx="40" cy="40" r="34"/>
                                <circle class="progress-ring-fill ${strokeClass}" cx="40" cy="40" r="34"
                                        stroke-dasharray="${circumference}"
                                        stroke-dashoffset="${offset}" />
                            </svg>
                            <div class="progress-text">
                                <div class="text-lg font-semibold">${phase.percent}%</div>
                            </div>
                        </div>
                        <div class="phase-name">${phase.name}</div>
                        <div class="phase-detail">${detail}</div>
                    </div>
                `;
            }).join('');

            document.getElementById('phases').innerHTML = `
                <h2 class="text-xs font-medium text-neutral-500 dark:text-neutral-400 uppercase tracking-wider mb-4">Project Progress</h2>
                <div class="phases-grid">
                    ${phaseCards}
                </div>
                <p class="mt-4 text-sm text-neutral-600 dark:text-neutral-300 text-center">
                    Target completion: <strong>${project.targetCompletion}</strong>
                </p>
            `;
        }

        function renderMilestones(milestones) {
            const items = milestones.map(m => {
                let markerClass = m.status;
                let markerContent = '';
                if (m.status === 'complete') {
                    markerContent = '<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><polyline points="20,6 9,17 4,12" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/></svg>';
                }

                return `
                    <div class="timeline-item">
                        <div class="timeline-marker ${markerClass}">${markerContent}</div>
                        <div>
                            <h4 class="font-medium">${m.title}</h4>
                            <p class="text-sm text-neutral-500 dark:text-neutral-400">${m.description}</p>
                            <span class="text-xs text-neutral-400 dark:text-neutral-500">${m.date}</span>
                        </div>
                    </div>
                `;
            }).join('');

            document.getElementById('milestones').innerHTML = `
                <h2 class="text-xs font-medium text-neutral-500 dark:text-neutral-400 uppercase tracking-wider mb-4">Project Milestones</h2>
                <div class="timeline">
                    ${items}
                </div>
            `;
        }

        function renderActivities(activities) {
            const items = activities.map(a => `
                <li class="flex gap-3 py-3 border-b border-neutral-100 dark:border-neutral-800 last:border-0">
                    <div class="activity-icon">
                        ${iconMap[a.icon] || iconMap.check}
                    </div>
                    <div class="flex-1 min-w-0">
                        <p class="font-medium">${a.title}</p>
                        <p class="text-sm text-neutral-500 dark:text-neutral-400">${a.description}</p>
                    </div>
                    <div class="text-right whitespace-nowrap">
                        <span class="text-xs text-neutral-400 dark:text-neutral-500">${a.date}</span>
                        ${a.hours ? `<div class="text-xs font-medium text-neutral-600 dark:text-neutral-300">${a.hours}h</div>` : ''}
                    </div>
                </li>
            `).join('');

            document.getElementById('activities').innerHTML = `
                <h2 class="text-xs font-medium text-neutral-500 dark:text-neutral-400 uppercase tracking-wider mb-4">Recent Activity</h2>
                <ul>
                    ${items}
                </ul>
            `;
        }

        // Load data when page loads
        loadData();
    </script>
</body>
</html>
